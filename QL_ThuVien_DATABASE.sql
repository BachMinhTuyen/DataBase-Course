CREATE DATABASE QL_THUVIEN
GO

USE QL_THUVIEN
GO

CREATE TABLE TACGIA
(
	MATG CHAR(5) NOT NULL PRIMARY KEY,
	TENTG NVARCHAR(40),
	DIACHI NVARCHAR(40),
)

CREATE TABLE LOAISACH
(
	MALOAI CHAR(2) NOT NULL PRIMARY KEY,
	TENLOAI NVARCHAR(10)
)

CREATE TABLE NHAXUATBAN
(
	MANXB CHAR(5) NOT NULL PRIMARY KEY,
	TENNXB NVARCHAR(50),
	DCNXB NVARCHAR(40),
	DTNXB VARCHAR(12)
)

CREATE TABLE SACH
(
	MASH CHAR(5) NOT NULL PRIMARY KEY,
	TENSH NVARCHAR(50),
	MATG CHAR(5),
	NAMXB INT,
	MANXB CHAR(5),
	MALOAI CHAR(2),
	CONSTRAINT FK_MATG FOREIGN KEY (MATG) REFERENCES TACGIA(MATG),
	CONSTRAINT FK_MANXB FOREIGN KEY (MANXB) REFERENCES NHAXUATBAN(MANXB),
	CONSTRAINT FK_MALOAI FOREIGN KEY (MALOAI) REFERENCES LOAISACH(MALOAI)
)

CREATE TABLE DOCGIA
(
	MADG CHAR(5) NOT NULL PRIMARY KEY,
	TENDG NVARCHAR(40),
	NGAYSINH DATE,
	GIOITINH NCHAR(3),
	LIENHE VARCHAR(11)
)

CREATE TABLE MUONTRASACH
(
	MADG CHAR(5) NOT NULL,
	MASH CHAR(5) NOT NULL,
	NGAYMUON DATE,
	NGAYTRA DATE,
	CONSTRAINT PK_MUONTRASACH PRIMARY KEY (MADG, MASH),
	CONSTRAINT FK_MADG FOREIGN KEY (MADG) REFERENCES DOCGIA(MADG),
	CONSTRAINT FK_MASH FOREIGN KEY (MASH) REFERENCES SACH(MASH)
)

INSERT INTO TACGIA(MATG, TENTG, DIACHI)
VALUES ('TG001', N'Nguyễn Hữu Anh', N'Q3, TP. HCM'),
('TG002', N'Tô Hoài', N'Bình Thạnh, TP. HCM'),
('TG003', N' Nguyễn Quang Sang', N'Trảng Bàng, Tây Ninh'),
('TG004', N'Hồ Tùng Mậu', N'Trảng Bom, Đồng Nai'),
('TG005', N'Thi Anh Trung', N'Bến Lức, Long An'),
('TG006', N'Nguyễn Nhật Ánh', N'Q1, TP. HCM')

INSERT INTO LOAISACH(MALOAI, TENLOAI)
VALUES ('SH', N'SÁCH'),
('TR', N'TRUYỆN'),
('TC', N'TẠP CHÍ')

INSERT INTO NHAXUATBAN(MANXB, TENNXB, DCNXB, DTNXB)
VALUES ('NXB01', N'Đại học quốc gia TP.HCM', N'Quận 1, TP. HCM','08.765348758'),
('NXB02', N'Đại học quốc gia Hà Nội', N'Quận Cầu Giấy, Hà Nội','04.765476574'),
('NXB03', N'Thanh Niên', N'Quận 3, TP. HCM','08.765475665'),
('NXB04', N'Tổng Hợp', N'Quận Thanh Xuân, Hà Nội','04.876847676'),
('NXB05', N'Nhi Đồng', N'Quận 10, TP. HCM','08.765746767')

INSERT SACH(MASH, TENSH, MATG, NAMXB, MANXB, MALOAI)
VALUES ('SH001', N'Toán Rời Rạc', 'TG001', 1998, 'NXB01', 'SH'),
('TR001', N'Dế mèn phiêu lưu ký', 'TG002', 1997, 'NXB05', 'TR'),
('TR002', N'Bàn có 5 chỗ ngồi', 'TG006', 2000, 'NXB05', 'TR'),
('TC001', N'Tạp chí Tin học và Điều khiển số 6/2015', 'TG003', 2015, 'NXB04', 'TC'),
('TC002', N'Tạp chí Tin học và Điều khiển số 9/2015', 'TG003', 2015, 'NXB04', 'TC'),
('SH002', N'Kỹ thuật lập trình C#', 'TG004', 1998, 'NXB04', 'SH')

INSERT INTO DOCGIA(MADG, TENDG, NGAYSINH, GIOITINH, LIENHE)
VALUES ('DG001', N'Nguyễn Thanh Nam','1990-09-13', N'Nam', '01681234567'),
('DG002', N'Lê Văn Anh','1994-04-24', N'Nam', '0982999011'),
('DG003', N'Trần Thanh Bình','1989-10-30', N'Nữ', '01659000123'),
('DG004', N'Nguyễn Thị Thanh','1997-02-02', N'Nữ', '01231452370')

INSERT INTO MUONTRASACH(MADG, MASH, NGAYMUON, NGAYTRA)
VALUES ('DG004', 'SH002','2016-05-21','2016-05-28'),
('DG001', 'SH001','2016-06-01','2016-06-02'),
('DG003', 'TC001','2016-06-01','2016-06-11'),
('DG001', 'SH002','2016-06-01', NULL)