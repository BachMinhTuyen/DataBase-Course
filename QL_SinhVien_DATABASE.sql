CREATE DATABASE QL_SINHVIEN
GO

USE QL_SINHVIEN
GO

CREATE TABLE KHOA
(
	MAKH CHAR(10) NOT NULL,
	TENKH NVARCHAR(30),
	CONSTRAINT PK_MAKH PRIMARY KEY (MAKH)
)

CREATE TABLE LOP
(
	MALOP CHAR(10) NOT NULL,
	TENLOP NVARCHAR(50),
	SISO INT,
	LOPTRUONG NVARCHAR(30),
	MAKH CHAR(10),
	CONSTRAINT PK_MALOP PRIMARY KEY (MALOP),
	CONSTRAINT FK_MAKH FOREIGN KEY (MAKH) REFERENCES KHOA(MAKH)
)

CREATE TABLE SINHVIEN
(
	MASV CHAR(10) NOT NULL,
	HOTEN NVARCHAR(30),
	NGSINH DATE,
	GTINH NVARCHAR(3),
	DCHI NVARCHAR(30),
	MALOP CHAR(10),
	CONSTRAINT PK_MASV PRIMARY KEY (MASV),
	CONSTRAINT FK_MALOP FOREIGN KEY (MALOP) REFERENCES LOP(MALOP)
)

CREATE TABLE GIANGVIEN
(
	MAGV CHAR(10) NOT NULL,
	TENGV NVARCHAR(30),
	MAKH CHAR(10),
	CONSTRAINT PK_MAGV PRIMARY KEY (MAGV),
	CONSTRAINT FK_MAKH_GV FOREIGN KEY (MAKH) REFERENCES KHOA(MAKH)
)

CREATE TABLE MONHOC
(
	MAMH CHAR(10) NOT NULL,
	TENMH NVARCHAR(50),
	SOTC INT,
	CONSTRAINT PK_MAMH PRIMARY KEY (MAMH)
)

CREATE TABLE DIEM
(
	MASV CHAR(10) NOT NULL,
	MAMH CHAR(10) NOT NULL,
	LANTHI INT,
	DIEMTHI FLOAT,
	CONSTRAINT PK_DIEM PRIMARY KEY (MASV, MAMH, LANTHI),
	CONSTRAINT FK_MASV_D FOREIGN KEY (MASV) REFERENCES SINHVIEN(MASV),
	CONSTRAINT FK_MAMH_D FOREIGN KEY (MAMH) REFERENCES MONHOC(MAMH)
)

CREATE TABLE GIANGDAY 
(
	MAGV CHAR(10) NOT NULL,
	MAMH CHAR(10) NOT NULL,
	NAMHOC VARCHAR(10),
	HOCKY INT,
	CONSTRAINT PK_GIANGDAY PRIMARY KEY (MAGV, MAMH),
	CONSTRAINT FK_MAGV_GD FOREIGN KEY (MAGV) REFERENCES GIANGVIEN(MAGV),
	CONSTRAINT FK_MAMH_GD FOREIGN KEY (MAMH) REFERENCES MONHOC(MAMH)
)

CREATE TABLE THANNHAN
(
	MATN CHAR(10) NOT NULL,
	HOTEN NVARCHAR(30),
	GIOITINH NVARCHAR(3),
	CONSTRAINT PK_MATN PRIMARY KEY (MATN)
)

CREATE TABLE QUANHE
(
	MATN CHAR(10) NOT NULL,
	MASV CHAR(10) NOT NULL,
	QUANHE NVARCHAR(10),
	CONSTRAINT PK_QUANHE PRIMARY KEY (MATN, MASV),
	CONSTRAINT FK_MATN_QH FOREIGN KEY (MATN) REFERENCES THANNHAN(MATN),
	CONSTRAINT FK_MASV_QH FOREIGN KEY (MASV) REFERENCES SINHVIEN(MASV)
)
GO

INSERT INTO KHOA (MAKH, TENKH)
VALUES ('SH', N'Công nghệ sinh học'),
('TH', N'Công nghệ thông tin'),
('TP', N'Công nghệ thực phẩm'),
('QT', N'Quản trị kinh doanh'),
('TC', N'Tài chính kế toán')

INSERT INTO LOP (MALOP, TENLOP, SISO, LOPTRUONG, MAKH)
VALUES ('10DHSH1',N'10 Đại học Sinh học 1', 55, 'SV008', 'SH'),
('10DHTH1',N'10 Đại học Tin học 1', 50, 'SV001', 'TH'),
('11DHTH2',N'11 Đại học Tin học 2', 40, 'SV005', 'TH'),
('12DHTC1',N'12 Đại học Tài chính 1', 75, 'SV009', 'TC'),
('12DHTP1',N'12 Đại học Thực phẩm 1', 60, 'SV007', 'TP')

INSERT INTO SINHVIEN (MASV, HOTEN, NGSINH, GTINH, DCHI, MALOP)
VALUES ('SV001', N'Trần Lệ Quyên', '1995-01-21', N'Nữ', N'TPHCM', '10DHTH1'),
('SV002', N'Nguyễn Thế Bình', '1996-06-04', N'Nam', N'Tây Ninh', '11DHTH2'),
('SV003', N'Tô Ánh Nguyệt', '1995-05-02', N'Nữ', N'Vũng Tàu', '12DHTP1'),
('SV004', N'Nguyễn Thế Anh', '1996-12-15', N'Nam', N'Đồng Nai', '12DHTP1'),
('SV005', N'Lê Thanh Bình', '1994-12-09', N'Nam', N'Long An', '10DHTH1'),
('SV006', N'Phạm Quang Hậu', '1995-10-12', N'Nam', N'Tây Ninh', '10DHTH1'),
('SV007', N'Lê Cẩm Tú', '1989-02-13', N'Nữ', N'Bình Thuận', '12DHTP1'),
('SV008', N'Trương Thế Sang', '1993-04-04', N'Nam', N'Bình Dương', '10DHSH1'),
('SV009', N'Đậu Quang Ánh', '1994-12-03', N'Nam', N'Long An', '12DHTC1'),
('SV010', N'Huỳnh Kim Chi', '1996-10-18', N'Nữ', N'TPHCM', '11DHTH2'),
('SV011', N'Trịnh Đình Ánh', '1995-11-15', N'Nam', N'Bình Thuận', '10DHTH1')

INSERT INTO GIANGVIEN (MAGV, TENGV, MAKH)
VALUES ('GV001', N'Phạm Thế Bảo', 'TH'),
('GV002', N'Lê Thể Truyền', 'TH'),
('GV003', N'Trương Anh Dũng', 'SH'),
('GV004', N'Bùi Chí Anh', 'TC'),
('GV005', N'Lê Công Hậu', 'QT'),
('GV006', N'Lê Trung Thành', 'TP')

INSERT INTO MONHOC (MAMH, TENMH, SOTC)
VALUES ('CSDL', N'Cơ sở dữ liệu', 3),
('KTLT', N'Kỹ thuật lập trình', 3),
('THVP', N'Tin học văn phòng', 3),
('TRR', N'Toán rời rạc', 3),
('TTNT', N'Trí tuệ nhân tạo', 2),
('TTQT', N'Thanh toán quốc tế', 2)

INSERT INTO DIEM (MASV, MAMH, LANTHI, DIEMTHI)
VALUES ('SV001', 'CSDL', 1, 9),
('SV002', 'THVP', 1, 3),
('SV002', 'THVP', 2, 7),
('SV004', 'THVP', 1, 6),
('SV004', 'TTQT', 1, 5),
('SV005', 'CSDL', 1, 3),
('SV005', 'CSDL', 2, 6),
('SV006', 'KTLT', 1, 4),
('SV009', 'TTQT', 1, 4),
('SV010', 'THVP', 1, 8),
('SV010', 'TRR', 1, 7)

INSERT INTO GIANGDAY (MAGV, MAMH, NAMHOC, HOCKY)
VALUES ('GV001', 'CSDL', '2021-2022', 1),
('GV001', 'KTLT', '2020-2021', 2),
('GV001', 'TTNT', '2020-2021', 1),
('GV002', 'CSDL', '2021-2022', 2),
('GV002', 'KTLT', '2021-2022', 2)

INSERT INTO THANNHAN (MATN, HOTEN, GIOITINH)
VALUES ('TN001', N'Nguyễn Thế Thành', N'Nam'),
('TN002', N'Tô Ánh Hồng', N'Nữ'),
('TN003', N'Lê Thanh An', N'Nam'),
('TN004', N'Phạm Thanh Tiền', N'Nữ'),
('TN006', N'Đậu Văn Thanh', N'Nam'),
('TN007', N'Nguyễn Thị Ánh', N'Nữ'),
('TN008', N'Lê Quang Định', N'Nam'),
('TN009', N'Huỳnh Văn Tư', N'Nam')

INSERT INTO QUANHE (MATN, MASV, QUANHE)
VALUES ('TN001', 'SV002', N'Bố'),
('TN004', 'SV005', N'Mẹ'),
('TN004', 'SV007', N'Mẹ'),
('TN006', 'SV009', N'Bố'),
('TN007', 'SV002', N'Mẹ'),
('TN008', 'SV005', N'Bố'),
('TN008', 'SV007', N'Bố')